import { Canvas, Meta } from '@storybook/blocks';

import * as SelectFieldStories from './select-field.stories';

<Meta of={SelectFieldStories} />

# SelectField
The SelectField component provides a customizable dropdown select input with support for grouped options, icons, and virtualized rendering for large datasets. It's built on React Aria Components and provides excellent accessibility out of the box. Select fields are commonly used in forms, settings panels, and anywhere users need to choose from a predefined list of options.

It is composed of the following components:

- **SelectField** - Main select dropdown with form field features
- **SelectFieldProvider** - Context provider for setting default props across multiple select fields
- **[Options](?path=/docs/components-options--playground)** Main container for all option items

## Example usage
```tsx
// Basic select field
<SelectField label="Choose a bird" placeholder="Select...">
  <OptionsItem textValue="Blue Jay">Blue Jay</OptionsItem>
  <OptionsItem textValue="Gray catbird">Gray catbird</OptionsItem>
  <OptionsItem textValue="Black-capped chickadee">Black-capped chickadee</OptionsItem>
</SelectField>

// With grouped options and icons
<SelectField label="Choose a bird" placeholder="Select...">
  <OptionsSection header="North American Birds">
    <OptionsItem textValue="Blue Jay">
      <Icon><Placeholder /></Icon>
      <OptionsItemLabel>Blue Jay</OptionsItemLabel>
    </OptionsItem>
    <OptionsItem textValue="Gray catbird">
      <Icon><Placeholder /></Icon>
      <OptionsItemLabel>Gray catbird</OptionsItemLabel>
    </OptionsItem>
  </OptionsSection>
</SelectField>

// Using context provider for default props
<SelectFieldProvider size="small">
  <SelectField label="Small Select 1" />
  <SelectField label="Small Select 2" />
</SelectFieldProvider>
```

## Variants

* **medium** - Standard size with full label and description support (default)
* **small** - Compact size with minimal label display and reduced padding

The size can be controlled via the `size` prop or set globally using the `SelectFieldProvider` component.

<Canvas of={SelectFieldStories.Default} />

## Controlled Selection
Setting a selected option is supported via the `selectedKey` and `onSelectionChange` prop. The selected key corresponds to the id prop of an item, so note that the items in your option list must have an `id` property. When Select is used with a dynamic collection (an `items` prop on `Options`), the id of each item is derived from the data.
<Canvas of={SelectFieldStories.ControlledSelection} />

## Props
All the props from the `Select` headless component are available in the `SelectField` component (except `className` which is expanded to `classNames`). [Details can be found in the docs](https://react-spectrum.adobe.com/react-aria/Select.html#props).

There are additional props that are specific to our implementation of `SelectField`:
* **`label`** - Text label displayed above the select field
* **`description`** - Helper text displayed below the select field
* **`errorMessage`** - Error text displayed when validation fails
* **`size`** - Size variant: `'medium'` (default) or `'small'`
* **`layoutOptions`** - Configuration for virtualized rendering of large option lists ([more details here](https://react-spectrum.adobe.com/react-aria/Virtualizer.html#listlayout))
* **`classNames`** - Custom class names for styling:
  * `field` - Applied to the select field container
  * `label` - Applied to the label element
  * `trigger` - Applied to the select button trigger
  * `value` - Applied to the selected value display
  * `description` - Applied to the description text
  * `error` - Applied to the error message

## Implementation Notes
The `SelectField` component wraps the `Select` component from `react-aria-components`.

[Docs](https://react-spectrum.adobe.com/react-aria/Select.html)

[Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/design-toolkit/components/src/components/search-field)

The underlying elements are:
- `div` for the select field container
- `button` for the select trigger
- `span` for the selected value display
- `div` for the label and description
- `div` for the error message
- `div` for the popover containing options

The component automatically handles accessibility features including:
- ARIA attributes for screen readers
- Keyboard navigation (Arrow keys, Enter, Escape, Space)
- Focus management
- Form integration
- Error state announcements
- Option grouping and section headers

The component integrates with the Options system for consistent option rendering and supports virtualized rendering for performance with large datasets (5000+ items).
