import { Canvas, Meta } from '@storybook/blocks';

import * as PopoverStories from './popover.stories';

<Meta of={PopoverStories} />

# Popover
A flexible and accessible popover component that provides contextual information, actions, or content overlays. Built on top of React Aria Components, the Popover component offers a comprehensive solution for displaying additional content without disrupting the main user interface flow. Perfect for tooltips, context menus, and informational overlays.

It is composed of the following components:

- **Popover** - Root component that manages popover state and positioning
- **PopoverTrigger** - Element that triggers the popover open
- **PopoverContent** - Main popover container with positioning and backdrop
- **PopoverTitle** - Optional semantic heading for the popover
- **PopoverBody** - Main content area for the popover
- **PopoverFooter** - Optional footer area for actions or additional content

## Example usage
```tsx
// Basic popover with title and content
<Popover>
  <PopoverTrigger>
    <Icon><Information /></Icon>
  </PopoverTrigger>
  <PopoverContent>
    <PopoverTitle>Information</PopoverTitle>
    <PopoverBody>This is helpful information.</PopoverBody>
  </PopoverContent>
</Popover>

// Popover with actions and footer
<Popover>
  <PopoverTrigger>
    <Button variant="icon">
      <Icon><Delete /></Icon>
    </Button>
  </PopoverTrigger>
  <PopoverContent>
    {({ close }) => (
      <>
        <PopoverTitle>Delete Item</PopoverTitle>
        <PopoverBody>Are you sure you want to delete this?</PopoverBody>
        <PopoverFooter>
          <Button variant="flat" onPress={close}>Cancel</Button>
          <Button variant="filled" onPress={close}>Delete</Button>
        </PopoverFooter>
      </>
    )}
  </PopoverContent>
</Popover>

// Custom placement and styling
<Popover placement="right">
  <PopoverTrigger>
    <span>Settings</span>
  </PopoverTrigger>
  <PopoverContent className="min-w-sm">
    <PopoverTitle>Settings</PopoverTitle>
    <PopoverBody>Configure your preferences here.</PopoverBody>
  </PopoverContent>
</Popover>
```

## Placements

The Popover component supports different placement options to position the popover relative to its trigger:

* **bottom** - Popover appears below the trigger (default)
* **top** - Popover appears above the trigger
* **left** - Popover appears to the left of the trigger
* **right** - Popover appears to the right of the trigger

**bottom** is the default placement and should be used for most use cases, while other placements are better suited for specific layout constraints or design requirements.

<Canvas of={PopoverStories.Simple} />

## Props

### Popover Props
- **`placement`** - Placement variant: `'left'` | `'right'` | `'top'` | `'bottom'` (default: `'bottom'`)
- **`children`** - Popover trigger and content components

### PopoverTrigger Props
- **`children`** - The trigger element (button, icon, text, etc.)
- **`className`** - Custom CSS class name for additional styling
- **`onPress`** - Press event handler for the trigger

### PopoverContent Props
- **`children`** - Popover content or render function with close callback
- **`className`** - Custom CSS class name for the popover container
- **`isOpen`** - Whether the popover is currently open
- **`onOpenChange`** - Callback when open state changes

### PopoverTitle Props
- **`children`** - Title text content
- **`className`** - Custom CSS class name for the title

### PopoverBody Props
- **`children`** - Body content
- **`className`** - Custom CSS class name for the body

### PopoverFooter Props
- **`children`** - Footer content (typically action buttons)
- **`className`** - Custom CSS class name for the footer

### HTML Attributes
The component accepts all standard HTML attributes for the respective elements, such as:
- **`id`** - Unique identifier
- **`aria-label`** - Accessible label
- **`data-*`** - Custom data attributes

## Features

### Flexible Content Rendering
Support for both static content and dynamic render functions:
```tsx
// Static content
<PopoverContent>
  <PopoverTitle>Static Title</PopoverTitle>
  <PopoverBody>Static content</PopoverBody>
</PopoverContent>

// Dynamic content with close callback
<PopoverContent>
  {({ close }) => (
    <>
      <PopoverTitle>Dynamic Title</PopoverTitle>
      <PopoverBody>Dynamic content</PopoverBody>
      <PopoverFooter>
        <Button onPress={close}>Close</Button>
      </PopoverFooter>
    </>
  )}
</PopoverContent>
```

### Placement Control
Automatic positioning with multiple placement options:
```tsx
// Different placements for different use cases
<Popover placement="top">...</Popover>    // Above trigger
<Popover placement="right">...</Popover>  // To the right
<Popover placement="left">...</Popover>   // To the left
<Popover placement="bottom">...</Popover> // Below trigger (default)
```

### Accessibility
Built-in accessibility features ensure proper interaction and screen reader support:
- **Focus Management**: Automatic focus handling when opening/closing
- **Screen Reader Support**: Proper ARIA attributes and semantic structure
- **Keyboard Navigation**: Escape key closes the popover
- **Backdrop Interaction**: Clicking outside closes the popover
- **Trigger Association**: Proper connection between trigger and content

### Custom Styling
Flexible styling through className props:
```tsx
<PopoverContent className="min-w-sm max-w-md">
  <PopoverTitle className="text-lg font-bold">Custom Title</PopoverTitle>
  <PopoverBody className="text-sm">Custom body styling</PopoverBody>
</PopoverContent>
```

## Examples

### Simple Popover
<Canvas of={PopoverStories.Simple} />

### With Actions
<Canvas of={PopoverStories.WithActions} />

### Custom Composition
<Canvas of={PopoverStories.CustomComposition} />

### Different Placements
```tsx
<div className="flex gap-4">
  <Popover placement="top">
    <PopoverTrigger><Button>Top</Button></PopoverTrigger>
    <PopoverContent>
      <PopoverBody>Appears above</PopoverBody>
    </PopoverContent>
  </Popover>

  <Popover placement="right">
    <PopoverTrigger><Button>Right</Button></PopoverTrigger>
    <PopoverContent>
      <PopoverBody>Appears to the right</PopoverBody>
    </PopoverContent>
  </Popover>
</div>
```

### Form in Popover
```tsx
<Popover>
  <PopoverTrigger>
    <Button>Edit Profile</Button>
  </PopoverTrigger>
  <PopoverContent>
    <PopoverTitle>Edit Profile</PopoverTitle>
    <PopoverBody>
      <form className="space-y-4">
        <input placeholder="Name" />
        <input placeholder="Email" />
      </form>
    </PopoverBody>
    <PopoverFooter>
      <Button variant="flat">Cancel</Button>
      <Button variant="filled">Save</Button>
    </PopoverFooter>
  </PopoverContent>
</Popover>
```

### Information Tooltip
```tsx
<Popover>
  <PopoverTrigger>
    <Icon className="text-blue-500"><Question /></Icon>
  </PopoverTrigger>
  <PopoverContent>
    <PopoverBody>
      This feature allows you to customize your experience.
    </PopoverBody>
  </PopoverContent>
</Popover>
```

## Use Cases

The Popover component is ideal for:

- **Tooltips**: Providing additional context for UI elements
- **Context Menus**: Quick actions related to specific content
- **Form Extensions**: Additional input fields or options
- **Information Overlays**: Help text, descriptions, or metadata
- **Action Confirmation**: Quick confirmations without page navigation
- **Settings Panels**: Compact configuration options

## Implementation Notes
The `Popover` component is built using React Aria Components and provides a flexible, accessible popover system with comprehensive positioning and content management.

[Docs](https://react-spectrum.adobe.com/react-aria/Popover.html)

[Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/design-toolkit/components/src/components/popover)

Key features:
- **Accessibility**: Full ARIA compliance with proper focus management and screen reader support
- **Flexible Positioning**: Multiple placement options with automatic positioning
- **Content Management**: Support for static and dynamic content rendering
- **Trigger Integration**: Seamless integration with various trigger elements
- **Responsive Design**: Automatic positioning that adapts to viewport constraints
- **Type Safety**: Full TypeScript support with comprehensive prop types
- **React Aria Integration**: Built on top of RAC for enhanced accessibility

The underlying HTML structure creates a semantic popover with proper accessibility:
```html
<div class="popover-trigger">
  <button>Trigger</button>
</div>
<div class="popover-content" role="dialog" aria-modal="true">
  <h3 class="popover-title">Title</h3>
  <div class="popover-body">Content</div>
  <div class="popover-footer">Actions</div>
</div>
```

This provides excellent accessibility and user experience while maintaining a clean, structured API for developers. The component automatically handles positioning, focus management, and screen reader support through React Aria Components.
