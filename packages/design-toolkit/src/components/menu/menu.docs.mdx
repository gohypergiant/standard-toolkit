import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as MenuStories from './menu.stories';

<Meta of={MenuStories} />

# Menu
A menu displays a list of actions or options that a user can choose.

Menu is a complex, composed component made up of smaller subcomponents. The subcomponents can only be used as elements of the larger `Menu` parent.

It is composed of the following components:

- **Menu** - Root menu component that wraps the dropdown portion
- **MenuTrigger** - Manages open/close behavior and anchors menu position
- **MenuItem** - Individual menu item with support for labels and description
- **MenuItemLabel** - Item display label (accessed via Text component with slot='label')
- **MenuItemDescription** - Item description subtext (accessed via Text component with slot='description')
- **MenuSeparator** - Visual line separator between menu sections
- **MenuSection** - Visually distinct section optional title
- **MenuSubmenu** - Nested submenu flyout for hierarchical items

Additionally, you can compose in a `Hotkey` component or `Icon` components within menu items.

> **Important:** The `Menu` component includes its own internal `Popover`. Do not wrap `Menu` in a `Popover` component—this will cause click handlers to not fire properly. Use the `popoverProps` prop to configure placement and other popover behavior.

## Static
You can construct a static menu by using the components directly.
<Canvas of={MenuStories.Basic} />

## Dynamic
For a dynamic menu, the `items` prop is passed in.
<Canvas of={MenuStories.Dynamic} />

## Simple Menu
A minimal menu without icons or descriptions.
<Canvas of={MenuStories.SimpleMenu} />

## Custom Placement
Use `popoverProps` to customize the menu position relative to the trigger.
<Canvas of={MenuStories.CustomPlacement} />

## With Offset
Use `popoverProps.offset` to control spacing between the trigger and menu.
<Canvas of={MenuStories.WithOffset} />

## With Action Handler
Use `onAction` to handle menu item selection. Each `MenuItem` should have an `id` prop.
<Canvas of={MenuStories.WithActionHandler} />

## Selection Modes

### Single Selection
Use `selectionMode='single'` to allow selecting one item at a time.
<Canvas of={MenuStories.SingleSelection} />

### Multiple Selection
Use `selectionMode='multiple'` to allow selecting multiple items.
<Canvas of={MenuStories.MultipleSelection} />

## Color Variants
Menu items support three color variants: `info` (default), `serious`, and `critical`.
<Canvas of={MenuStories.ColorVariants} />

## Disabled Items
Use `isDisabled` on individual menu items to prevent interaction.
<Canvas of={MenuStories.DisabledItems} />

## Context Menu
A custom context menu triggered by right-click, using `popoverProps` for controlled positioning.
<Canvas of={MenuStories.ContextMenu} />

## Dynamic Section Header
Section titles can be strings or React elements for custom formatting.
<Canvas of={MenuStories.DynamicMenuHeader} />

## Example Usage

### Simplest Version
```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSeparator />
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

### With Custom Placement
```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu popoverProps={{ placement: 'top end' }}>
    <MenuItem>
      <MenuItemLabel>Item 1</MenuItemLabel>
    </MenuItem>
    <MenuItem>
      <MenuItemLabel>Item 2</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

Available placements include: `'bottom'`, `'bottom start'`, `'bottom end'`, `'top'`, `'top start'`, `'top end'`, `'left'`, `'right'`, etc.

### With Offset
```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu popoverProps={{ placement: 'bottom', offset: 8 }}>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

### With Action Handler
```tsx
<MenuTrigger>
  <Button>Actions</Button>
  <Menu onAction={(key) => console.log('Selected:', key)}>
    <MenuItem id="edit">
      <MenuItemLabel>Edit</MenuItemLabel>
    </MenuItem>
    <MenuItem id="copy">
      <MenuItemLabel>Copy</MenuItemLabel>
    </MenuItem>
    <MenuItem id="delete">
      <MenuItemLabel>Delete</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

### With Selection
```tsx
const [selectedKeys, setSelectedKeys] = useState(new Set(['item-1']));

<MenuTrigger>
  <Button>Select Items</Button>
  <Menu
    selectionMode="multiple"
    selectedKeys={selectedKeys}
    onSelectionChange={setSelectedKeys}
  >
    <MenuItem id="item-1">
      <MenuItemLabel>Item 1</MenuItemLabel>
    </MenuItem>
    <MenuItem id="item-2">
      <MenuItemLabel>Item 2</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

### With Section
```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSection title='Additional Notable Species'>
      <MenuItem>
        <MenuItemLabel>Mallard</MenuItemLabel>
        <MenuItemDescription>Anas platyrhynchos</MenuItemDescription>
        <Hotkey variant='flat'>⌘V</Hotkey>
      </MenuItem>
      <MenuItem>
        <MenuItemLabel>Chimney swift</MenuItemLabel>
        <MenuItemDescription>Chaetura pelagica</MenuItemDescription>
      </MenuItem>
    </MenuSection>
  </Menu>
</MenuTrigger>
```

### With Submenu
```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSubmenu>
      <MenuItem>
        <MenuItemLabel>Item With Children</MenuItemLabel>
      </MenuItem>
      <Menu>
        <MenuItem>
          <MenuItemLabel>Blue Jay</MenuItemLabel>
        </MenuItem>
      </Menu>
    </MenuSubmenu>
  </Menu>
</MenuTrigger>
```

## Props
The Menu supports all the [props from `react-aria-components` Menu](https://react-spectrum.adobe.com/react-aria/Menu.html#props).

### Menu Props
- **`selectionMode`** - Selection behavior: `'single'` (default) | `'multiple'` | `'none'`
- **`variant`** - Visual variant for styling: `'cozy'` (default) | `'compact'`
- **`classNames`** - Custom class names for different parts:
  - `menu` - Applied to the menu container
  - `popover` - Applied to the popover wrapper
- **`popoverProps`** - Props passed to the underlying Popover component. Use this to set `placement`, `offset`, `isOpen`, etc. See [Popover props](https://react-spectrum.adobe.com/react-aria/Popover.html#props) for all options.
- **`onAction`** - Handler called when a menu item is selected. Receives the item's `id` as argument.
- **`onClose`** - Handler called when the menu is closed.

### MenuItem Props
- **`color`** - Color variant: `'info'` (default) | `'serious'` | `'critical'`
- **`classNames`** - Custom class names for different parts:
  - `item` - Applied to menu item
  - `icon` - Applied to icons
  - `hotkey` - Applied to hotkey display
  - `more` - Applied to submenu indicators
  - `text` - Applied to text content

### MenuSection Props
- **`title`** - Optional section title, this can be a string or ReactElement
- **`classNames`** - Custom class names for different parts:
  - `section` - Applied to the section container
  - `header` - Applied to the section header

### MenuTrigger Props
The MenuTrigger component supports all the [props from `react-aria-components` MenuTrigger](https://react-spectrum.adobe.com/react-aria/Menu.html#menutrigger).

### MenuSubmenu Props
The MenuSubmenu component supports all the [props from `react-aria-components` Submenu](https://react-spectrum.adobe.com/react-aria/Menu.html#submenu).

### MenuItemLabel Props
- **`children`** - Label text content
- **`className`** - Custom CSS class name for styling

### MenuItemDescription Props
- **`children`** - Description text content
- **`className`** - Custom CSS class name for styling

### MenuSeparator Props
- **`className`** - Custom CSS class name for styling

## Common Mistakes

### ❌ Don't wrap Menu in Popover
```tsx
// WRONG - This will cause click handlers to not fire
<MenuTrigger>
  <Button>Open Menu</Button>
  <Popover placement="top end">
    <Menu onAction={handleAction}>
      <MenuItem id="edit">Edit</MenuItem>
    </Menu>
  </Popover>
</MenuTrigger>
```

### ✅ Use popoverProps instead
```tsx
// CORRECT - Use popoverProps for placement
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu popoverProps={{ placement: 'top end' }} onAction={handleAction}>
    <MenuItem id="edit">Edit</MenuItem>
  </Menu>
</MenuTrigger>
```

## Implementation Notes

The `Menu` component is based on the `Menu` component from `react-aria-components`.

[Docs](https://react-spectrum.adobe.com/react-aria/Menu.html) -->

[Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/menu)

