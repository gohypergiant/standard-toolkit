import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as MenuStories from './menu.stories';

<Meta of={MenuStories} />

# Menu

A menu displays a list of actions or options that a user can choose.

Menu is a composed component made up of smaller subcomponents: `Menu`, `MenuTrigger`, `MenuItem`, `MenuItemLabel`, `MenuItemDescription`, `MenuSeparator`, `MenuSection`, and `MenuSubmenu`. You can also compose in `Hotkey` and `Icon` components within menu items.

> **Important:** The `Menu` component includes its own internal `Popover`. Do not wrap `Menu` in a `Popover` - use the `popoverProps` prop instead.

<Canvas of={MenuStories.Basic} />

## Dynamic

<Canvas of={MenuStories.Dynamic} />

## Simple Menu

A minimal menu without icons or descriptions.

<Canvas of={MenuStories.SimpleMenu} />

```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSeparator />
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

## Custom Placement

Use `popoverProps` to customize the menu position relative to the trigger.

<Canvas of={MenuStories.CustomPlacement} />

```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu popoverProps={{ placement: 'top end' }}>
    <MenuItem>
      <MenuItemLabel>Item 1</MenuItemLabel>
    </MenuItem>
    <MenuItem>
      <MenuItemLabel>Item 2</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

Available placements: `'bottom'`, `'bottom start'`, `'bottom end'`, `'top'`, `'top start'`, `'top end'`, `'left'`, `'right'`, etc.

## With Offset

Use `popoverProps.offset` to control spacing between the trigger and menu.

<Canvas of={MenuStories.WithOffset} />

```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu popoverProps={{ placement: 'bottom', offset: 8 }}>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

## With Action Handler

Use `onAction` to handle menu item selection. Each `MenuItem` should have an `id` prop.

<Canvas of={MenuStories.WithActionHandler} />

```tsx
<MenuTrigger>
  <Button>Actions</Button>
  <Menu onAction={(key) => console.log('Selected:', key)}>
    <MenuItem id="edit">
      <MenuItemLabel>Edit</MenuItemLabel>
    </MenuItem>
    <MenuItem id="delete">
      <MenuItemLabel>Delete</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

## Selection Modes

### Single Selection

Use `selectionMode='single'` to allow selecting one item at a time.

<Canvas of={MenuStories.SingleSelection} />

### Multiple Selection

Use `selectionMode='multiple'` to allow selecting multiple items.

<Canvas of={MenuStories.MultipleSelection} />

```tsx
const [selectedKeys, setSelectedKeys] = useState(new Set(['item-1']));

<MenuTrigger>
  <Button>Select Items</Button>
  <Menu
    selectionMode="multiple"
    selectedKeys={selectedKeys}
    onSelectionChange={setSelectedKeys}
  >
    <MenuItem id="item-1">
      <MenuItemLabel>Item 1</MenuItemLabel>
    </MenuItem>
    <MenuItem id="item-2">
      <MenuItemLabel>Item 2</MenuItemLabel>
    </MenuItem>
  </Menu>
</MenuTrigger>
```

## Color Variants

Menu items support three color variants: `info` (default), `serious`, and `critical`.

<Canvas of={MenuStories.ColorVariants} />

## Disabled Items

Use `isDisabled` on individual menu items to prevent interaction.

<Canvas of={MenuStories.DisabledItems} />

## Context Menu

A custom context menu triggered by right-click, using `popoverProps` for controlled positioning.

<Canvas of={MenuStories.ContextMenu} />

## Dynamic Section Header

Section titles can be strings or React elements for custom formatting.

<Canvas of={MenuStories.DynamicMenuHeader} />

```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSection title='Additional Notable Species'>
      <MenuItem>
        <MenuItemLabel>Mallard</MenuItemLabel>
        <MenuItemDescription>Anas platyrhynchos</MenuItemDescription>
        <Hotkey variant='flat'>âŒ˜V</Hotkey>
      </MenuItem>
    </MenuSection>
  </Menu>
</MenuTrigger>
```

## With Submenu

```tsx
<MenuTrigger>
  <Button>Open Menu</Button>
  <Menu>
    <MenuItem>
      <MenuItemLabel>Item</MenuItemLabel>
    </MenuItem>
    <MenuSubmenu>
      <MenuItem>
        <MenuItemLabel>Item With Children</MenuItemLabel>
      </MenuItem>
      <Menu>
        <MenuItem>
          <MenuItemLabel>Blue Jay</MenuItemLabel>
        </MenuItem>
      </Menu>
    </MenuSubmenu>
  </Menu>
</MenuTrigger>
```

## Props

Extends [React Aria Menu](https://react-spectrum.adobe.com/react-aria/Menu.html#props).

### Menu

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `variant` | `'cozy' \| 'compact'` | `'cozy'` | Visual variant for sizing |
| `selectionMode` | `'none' \| 'single' \| 'multiple'` | `'none'` | Selection behavior |
| `popoverProps` | `PopoverProps` | - | Props passed to the underlying Popover |
| `classNames` | `{ menu?, popover? }` | - | Custom class names for parts |
| `onAction` | `(key: Key) => void` | - | Handler when item is selected |
| `onClose` | `() => void` | - | Handler when menu closes |

### MenuItem

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `color` | `'info' \| 'serious' \| 'critical'` | `'info'` | Color variant |
| `isDisabled` | `boolean` | `false` | Whether item is disabled |
| `classNames` | `{ item?, icon?, hotkey?, more?, text? }` | - | Custom class names for parts |

### MenuSection

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `title` | `ReactNode` | - | Section header title |
| `classNames` | `{ section?, header? }` | - | Custom class names for parts |

### MenuItemLabel

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `ReactNode` | - | Label text content |
| `className` | `string` | - | Custom CSS class |

### MenuItemDescription

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `ReactNode` | - | Description text content |
| `className` | `string` | - | Custom CSS class |

### MenuSeparator

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Custom CSS class |

### MenuTrigger

See [React Aria MenuTrigger](https://react-spectrum.adobe.com/react-aria/Menu.html#menutrigger).

### MenuSubmenu

See [React Aria Submenu](https://react-spectrum.adobe.com/react-aria/Menu.html#submenu).

## Accessibility

- Full keyboard navigation with Arrow keys
- Type-ahead selection support
- Submenu navigation with Arrow Left/Right
- Escape closes menu and returns focus to trigger
- Screen reader announcements for selection changes

## Related

- [React Aria Menu](https://react-spectrum.adobe.com/react-aria/Menu.html)
- [GitHub Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/menu)

