import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as ViewStackStories from './view-stack.stories';

<Meta of={ViewStackStories}/>

# ViewStack

Stack-based navigation system for managing multiple views with push, pop, and reset operations.

```tsx
import { uuid } from '@accelint/core';

const ids = {
  stack: uuid(),
  a: uuid(),
  b: uuid(),
};

// Basic stack navigation
<ViewStack id={ids.stack} defaultView={ids.a}>
  <ViewStackView id={ids.a}>
    <ViewStackTrigger for={ids.b}>
      <Button>Push View B</Button>
    </ViewStackTrigger>
    <h1>View A</h1>
  </ViewStackView>
  <ViewStackView id={ids.b}>
    <ViewStackTrigger for='back'>
      <Button variant='icon'>
        <Icon><ChevronLeft /></Icon>
      </Button>
    </ViewStackTrigger>
    <h1>View B</h1>
  </ViewStackView>
</ViewStack>

// External control with targeted events
<ViewStackTrigger for={`reset:${ids.stack}`}>
  <Button>Reset Stack</Button>
</ViewStackTrigger>

// Chained events
<ViewStackTrigger for={['clear', ids.a, ids.b]}>
  <Button>Clear and Push Multiple</Button>
</ViewStackTrigger>
```

<Canvas of={ViewStackStories.Default} />

## ViewStack Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `UniqueId` | — | Unique identifier for the stack (required) |
| `defaultView` | `UniqueId` | — | Initial view to display |
| `onChange` | `(view: UniqueId \| null) => void` | — | Callback when active view changes |
| `children` | `ReactNode` | — | ViewStackView components and other content |

## ViewStackView Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `UniqueId` | — | Unique identifier for the view (required) |
| `children` | `ReactNode` | — | Content displayed when this view is active |

## ViewStackTrigger Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `for` | `SimpleEvents \| TargetedEvents \| ChainedEvents` | — | Trigger action (required) |
| `children` | `ReactNode` | — | Trigger content |

### Trigger Actions

**Simple Events** (within ViewStack context):
- `'back'` - Pop current view, return to previous
- `'clear'` - Remove all views from stack
- `'reset'` - Clear and return to defaultView
- `UniqueId` - Push specified view onto stack

**Targeted Events** (work from anywhere):
- `` `back:${stackId}` `` - Back on specific stack
- `` `clear:${stackId}` `` - Clear specific stack
- `` `reset:${stackId}` `` - Reset specific stack

**Chained Events** (array of actions):
- `['clear', viewId1, viewId2]` - Execute multiple actions in sequence

## useViewStackEmit

Hook for programmatic control of ViewStack from anywhere in the application.

```tsx
const emit = useViewStackEmit();

// Programmatic navigation
emit.push(viewId);
emit.back(stackId);
emit.clear(stackId);
emit.reset(stackId);
```

## Accessibility

- Keyboard navigation via trigger elements
- Focus management between views
- Proper ARIA labeling through trigger children

## Related

- [GitHub Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/view-stack)
