import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as AvatarStories from './avatar.stories';

<Meta of={AvatarStories} />

# Avatar
The Avatar component displays a user's profile picture, initials, or a fallback icon. Avatars are commonly used in user interfaces to represent users, display profile pictures, show online status, and provide visual identification in lists, headers, and user management systems.

It is composed of the following components:

- **Avatar** - Main avatar component that renders profile picture with fallback support
- **AvatarProvider** - Context provider for setting default props across multiple avatars

## Example Usage

### Basic
```tsx
<Avatar
  imageProps={{
    alt: "User profile",
    src: "https://example.com/avatar.jpg"
  }}
/>
```
<Canvas of={AvatarStories.Default} />

### With Badge
Badges are automatically positioned in the top-right corner.
```tsx
<Avatar
  imageProps={{
    alt: "User with notification",
    src: "https://example.com/avatar.jpg"
  }}
>
  <Badge color="critical">99+</Badge>
</Avatar>
```
<Canvas of={AvatarStories.WithBadge} />

### With Fallback
When the image fails to load, the fallback content displays. If no `fallbackProps.children` is provided, a default Person icon is shown.
```tsx
// Custom icon fallback
<Avatar
  imageProps={{ alt: "User", src: "http://broken-url.com" }}
  fallbackProps={{ children: <Icon><Placeholder /></Icon> }}
/>

// Initials fallback
<Avatar
  imageProps={{ alt: "User", src: "http://broken-url.com" }}
  fallbackProps={{ children: "DS" }}
/>
```
<Canvas of={AvatarStories.WithFallback} />

## Sizes
* **medium** - Standard size (32px) with larger text (default)
* **small** - Compact size (24px) with smaller text for space-constrained layouts

The size can be controlled via the `size` prop or set globally using the `AvatarProvider` component.

## Props
Extends all standard HTML `span` attributes.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `size` | `'medium' \| 'small'` | `'medium'` | Avatar size |
| `imageProps` | `object` | - | Props for the image element (see below) |
| `fallbackProps` | `object` | - | Props for the fallback element (see below) |
| `classNames` | `object` | - | Custom class names (see below) |
| `children` | `ReactNode` | - | Overlay content (badges, status indicators) |

**imageProps:**
| Prop | Type | Description |
|------|------|-------------|
| `src` | `string` | Image source URL |
| `alt` | `string` | Alternative text for accessibility |
| `onLoad` | `() => void` | Called when image loads |
| `onError` | `() => void` | Called when image fails to load |

**fallbackProps:**
| Prop | Type | Description |
|------|------|-------------|
| `children` | `ReactNode` | Fallback content (initials, icon). Defaults to Person icon |

**classNames:**
| Key | Description |
|-----|-------------|
| `avatar` | Applied to the avatar container |
| `image` | Applied to the image element |
| `fallback` | Applied to the fallback element |
| `content` | Applied to the content overlay |

### AvatarProvider
Context provider for setting default props across multiple avatars.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `size` | `'medium' \| 'small'` | - | Size applied to all child Avatars |
| `children` | `ReactNode` | - | Avatar components |

```tsx
<AvatarProvider size="small">
  <Avatar imageProps={{ alt: "User 1", src: "avatar1.jpg" }} />
  <Avatar imageProps={{ alt: "User 2", src: "avatar2.jpg" }} />
</AvatarProvider>
```

## Implementation Notes
- Wraps `@radix-ui/react-avatar` (Root, Image, Fallback)
- Uses CSS Grid for positioning image, fallback, and content overlay
- Fallback displays automatically when image fails to load
- Default fallback is a Person icon when no `fallbackProps.children` provided
- Badge children are automatically positioned top-right via BadgeProvider

**Related:**
- [Radix Avatar Docs](https://www.radix-ui.com/primitives/docs/components/avatar)
- [Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/avatar)
