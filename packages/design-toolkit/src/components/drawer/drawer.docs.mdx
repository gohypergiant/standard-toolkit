import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as DrawerStories from './drawer.stories';

<Meta of={DrawerStories} />

# Drawer
A slide-in panel for navigation or contextual content. Built on the ViewStack system for stacked views, programmatic triggers, and nested navigation.

Components:
- **Drawer** - Root component managing state and view stack
- **[DrawerLayout](?path=/docs/components-drawerlayout--playground)** - Layout container for panel positioning
- **DrawerMenu** - Navigation menu for switching views
- **DrawerMenuItem** - Individual menu item with tooltip support
- **DrawerPanel** - Main panel container
- **DrawerView** - Content region for a specific view
- **DrawerHeader** - Header with optional title prop for automatic layout
- **DrawerHeaderTitle** - Semantic heading element
- **DrawerClose** - Close button for the drawer
- **DrawerContent** - Main content area
- **DrawerFooter** - Footer region for actions
- **DrawerTrigger** - Programmatic trigger for drawer/view actions

## Example Usage

### Using the Title Prop
```tsx
import { useId } from 'react';

function MyDrawer() {
  const baseId = useId();
  const ids = {
    drawer: `${baseId}-drawer`,
    a: `${baseId}-a`,
    b: `${baseId}-b`,
  };

  return (
    <Drawer id={ids.drawer} defaultView={ids.a}>
      <DrawerMenu>
        <DrawerMenuItem for={ids.a}>View A</DrawerMenuItem>
        <DrawerMenuItem for={ids.b}>View B</DrawerMenuItem>
      </DrawerMenu>
      <DrawerPanel>
        <DrawerView id={ids.a}>
          <DrawerHeader title="Title A" />
          <DrawerContent>Content for View A</DrawerContent>
          <DrawerFooter>Footer Actions</DrawerFooter>
        </DrawerView>
        <DrawerView id={ids.b}>
          <DrawerHeader title="Title B" />
          <DrawerContent>Content for View B</DrawerContent>
        </DrawerView>
      </DrawerPanel>
    </Drawer>
  );
}
```

**⚠️ Important:** When using Drawer in Next.js or SSR environments, always use React's `useId()` hook instead of `uuid()` from `@accelint/core`. Using `uuid()` inside components (even with `useMemo` or `useState`) will cause hydration mismatches because different IDs are generated on the server vs client.

```tsx
// ❌ NEVER - Causes hydration mismatch in SSR
function MyDrawer() {
  const ids = useMemo(() => ({ drawer: uuid(), a: uuid() }), []); // Different IDs on server vs client!
  return <Drawer id={ids.drawer}>...</Drawer>;
}

// ✅ CORRECT - useId() is stable across server/client
function MyDrawer() {
  const baseId = useId();
  const ids = { drawer: `${baseId}-drawer`, a: `${baseId}-a` };
  return <Drawer id={ids.drawer}>...</Drawer>;
}

// ✅ ALSO CORRECT - Module-level constant (if ID should be shared across instances)
import { uuid } from '@accelint/core';
const DRAWER_ID = uuid();
function MyDrawer() {
  return <Drawer id={DRAWER_ID}>...</Drawer>;
}
```

### Custom Header Layout
```tsx
<DrawerHeader>
  <DrawerHeaderTitle level={2}>Custom Title</DrawerHeaderTitle>
  <DrawerClose for={views.idA} />
</DrawerHeader>
```

<Canvas of={DrawerStories.StaticHeaderFooter} />

## Sizes

| Size | Description |
|------|-------------|
| `small` | Compact drawer with minimal width |
| `medium` | Standard size with balanced content space (default) |
| `large` | Spacious drawer for complex interfaces |

## Props

### Drawer

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `UniqueId` | - | Unique identifier (required) |
| `placement` | `'top' \| 'bottom' \| 'left' \| 'right'` | `'left'` | Position of the drawer |
| `size` | `'small' \| 'medium' \| 'large'` | `'medium'` | Size variant |
| `defaultView` | `UniqueId` | - | ID of the initial view |
| `onChange` | `(view: UniqueId \| null) => void` | - | Called when active view changes |

### DrawerMenu

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `position` | `'start' \| 'center' \| 'end'` | `'center'` | Position of menu items |

### DrawerMenuItem

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `for` | `UniqueId` | - | View ID to navigate to (required) |
| `toggle` | `boolean` | `false` | Toggle view open/closed vs only open |
| `textValue` | `string` | - | Tooltip text on hover (required) |
| `classNames` | `object` | - | Custom classes for `item` and `tooltip` |

### DrawerHeader

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `title` | `string` | - | Auto-creates header with back/close buttons |
| `children` | `ReactNode` | - | Custom header content (alternative to title) |

When using `title`, the component automatically adds back navigation (for nested views) and close button.

### DrawerHeaderTitle

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `level` | `1-6` | - | Semantic heading level |
| `children` | `ReactNode` | - | Title text |


### DrawerClose

Close button that triggers a 'close' action to close the entire drawer.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `for` | `UniqueId` | - | Optional drawer ID to close. Defaults to current drawer |
| `aria-label` | `string` | - | Optional accessible label for the button |

### DrawerTrigger
Controls drawer state or navigates to views.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `for` | `'open' \| 'toggle' \| 'close' \| UniqueId \| Array` | - | Action or view ID |

- `'open'`, `'toggle'`, `'close'`: Control drawer state
- `UniqueId`: Push view onto stack
- `Array`: Fire multiple events in sequence

## Accessibility
- ARIA roles and keyboard support built-in
- Focus management for panel open/close
- DrawerMenuItem tooltips enhance accessibility

## Implementation Notes
- Uses Tagged UUIDs for view identification
- Events managed via `@accelint/bus`
- Integrates with [ViewStack](?path=/docs/components-viewstack--playground) for stacked navigation
- Only one DrawerPanel allowed per Drawer; DrawerMenu is optional

**Related:**
- [DrawerLayout](?path=/docs/components-drawerlayout--playground)
- [ViewStack](?path=/docs/components-viewstack--playground)
- [Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/drawer)
