import { Canvas, Meta } from '@storybook/addon-docs/blocks';

import * as SelectFieldStories from './select-field.stories';

<Meta of={SelectFieldStories} />

# SelectField

A dropdown select input with form field features, grouped options, and virtualized rendering for large datasets.

## Basic

```tsx
<SelectField label="Choose a bird" placeholder="Select...">
  <OptionsItem textValue="Blue Jay">Blue Jay</OptionsItem>
  <OptionsItem textValue="Gray catbird">Gray catbird</OptionsItem>
  <OptionsItem textValue="Black-capped chickadee">Black-capped chickadee</OptionsItem>
</SelectField>
```

<Canvas of={SelectFieldStories.Default} />

## With Grouped Options

```tsx
<SelectField label="Choose a bird" placeholder="Select...">
  <OptionsSection header="North American Birds">
    <OptionsItem textValue="Blue Jay">
      <Icon><Placeholder /></Icon>
      <OptionsItemLabel>Blue Jay</OptionsItemLabel>
    </OptionsItem>
    <OptionsItem textValue="Gray catbird">
      <Icon><Placeholder /></Icon>
      <OptionsItemLabel>Gray catbird</OptionsItemLabel>
    </OptionsItem>
  </OptionsSection>
</SelectField>
```

## Controlled Selection

The `selectedKey` corresponds to the `id` prop of an item. With dynamic collections (`items` prop on `Options`), the id is derived from the data.

<Canvas of={SelectFieldStories.ControlledSelection} />

## Readonly

Set `isReadOnly` to display the current selection as non-interactive text. A `selectedKey` or `value` is required to show content when `isReadOnly` is true. Without a selected value, the field appears empty.

<Canvas of={SelectFieldStories.Readonly} />

## With Provider

```tsx
<SelectFieldProvider size="small">
  <SelectField label="Small Select 1" />
  <SelectField label="Small Select 2" />
</SelectFieldProvider>
```

## Component Structure

- **SelectField**: Main select dropdown with form field features
- **SelectFieldProvider**: Context provider for default props
- **[Options](?path=/docs/components-options--docs)**: Container for option items

## Props

### SelectField

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `label` | `ReactNode` | — | Label displayed above the select |
| `description` | `ReactNode` | — | Helper text below the select |
| `errorMessage` | `string` | — | Error text when validation fails |
| `placeholder` | `string` | — | Placeholder text when no selection |
| `size` | `'medium' \| 'small'` | `'medium'` | Size variant |
| `selectedKey` | `Key` | — | Controlled selected item key |
| `onSelectionChange` | `(key: Key) => void` | — | Called when selection changes |
| `isDisabled` | `boolean` | `false` | Disables the select |
| `isRequired` | `boolean` | `false` | Marks selection as required |
| `isInvalid` | `boolean` | `false` | Shows error state |
| `isReadOnly` | `boolean` | `false` | Read-only display mode |
| `layoutOptions` | `ListLayoutOptions` | — | [Virtualizer options](https://react-spectrum.adobe.com/react-aria/Virtualizer.html#listlayout) |
| `classNames` | `object` | — | Custom classes: `field`, `label`, `trigger`, `value`, `description`, `error`, `popover` |

### SelectFieldProvider

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `size` | `'medium' \| 'small'` | — | Default size for child SelectFields |
| `children` | `ReactNode` | — | SelectField components |

## Accessibility

- Arrow keys navigate options
- Enter/Space selects focused option
- Escape closes dropdown
- Automatic ARIA attributes and error announcements

## Related

- [Options](?path=/docs/components-options--docs)
- [React Aria Select](https://react-spectrum.adobe.com/react-aria/Select.html)
- [GitHub Source](https://github.com/gohypergiant/standard-toolkit/tree/main/packages/design-toolkit/src/components/select-field)
