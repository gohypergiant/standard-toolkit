import { Meta } from '@storybook/blocks';
import * as ViewportStories from './viewport-size.stories.tsx'

<Meta of={ViewportStories} />

# Viewport

## useViewportState
A react hook for syncing to viewport events.  A thin wrapper around [useSyncExternalStore](https://react.dev/reference/react/useSyncExternalStore), it provides default `subscribe` and `getSnapshot` functions that listen to the Bus for viewport events and signal react to re-render.

### Usage

```typescript
import { useViewportState } from '@accelint/map-toolkit/viewport'

// basic usage
function MapInfo() {
  const { bounds, latitude, longitude, zoom } = useViewportState({
    viewId: 'default'
  });

  return (
    <div>
      Lat: {latitude?.toFixed(2)}, Lon: {longitude?.toFixed(2)}, Zoom: {zoom}
    </div>
  );
}

// customized
const customSubscribe = (onStoreChange) => {
  // Custom subscription logic
  return () => { // cleanup }
}

const customGetSnapshot = () => {
  // Custom snapshot logic
  return { latitude: 0, longitude: 0, zoom: 1 };
};

function CustomMapInfo() {

  const viewState = useViewportState({
    viewId: 'custom',
    subscribe: customSubscribe,
    getSnapshot: customGetSnapshot,
  });

  return <div>Custom viewport state</div>;
}
```

## ViewportScale
A react component that consumes `useViewportState` and displays the current viewport scale for the selected scale unit (defaults to Nautical Miles, NMI) in a `<span>`

### Usage

`<ViewportScale>` updates by subscribing to viewport events from the Bus.  The easiest way to send those events with DeckGL is by initializing the `ViewportSyncWidget` in the BaseMap.

```typescript
import { BaseMap } from '@accelint/map-toolkit/deckgl'
import { ViewportSyncWidget } from '@accelint/map-toolkit/deckgl/widgets/viewport-sync'
import { ViewportSize } from '@accelint/map-toolkit/viewport'

const WIDGETS = [new ViewportSyncWidget({ id: 'viewport-sync' })];

export function MapView() {
  return (
    <>
      <ViewportSize viewId="default" className='absolute right-xl bottom-xl rounded-medium bg-surface-overlay p-l shadow-elevation-raised' />
      <BaseMap widgets={WIDGETS} className="w-full h-full">
    </>
  )
}
```

### Props

### unit
`'km' | 'm' | 'nmi' | 'mi' | 'ft'`
Takes an abbreviated unit string. Supports kilometers, meters, nautical miles, miles, and feet. Defaults to nautical miles.

### className
Passes the css class to the span. Unstyled by default.

